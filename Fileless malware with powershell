# Detection Use Case: Fileless Malware with PowerShell (T1059.001)

## Scenario Description
I simulated a spear-phishing attack leading to fileless malware execution on a Windows VM (IP: 192.168.123.129). A user (`user1`) executed a malicious PowerShell command that downloaded and ran a script (`malicious.ps1`) from my host (IP: 192.168.123.1:8080) in memory, creating a file `C:\Temp\compromised.txt` as proof.

## Objective
The goal was to detect fileless malware execution via PowerShell, mapping to MITRE ATT&CK T1059.001 (Command and Scripting Interpreter: PowerShell).

## Tools Used
- **SIEM:** Splunk (on host Windows machine)
- **Log Source:** Windows VM (Windows 10)
- **Monitoring Tool:** Sysmon on the Windows VM

## Event ID / Data Source Mapping
- **Log Source:** Sysmon (Event ID 1: Process Creation, Event ID 3: Network Connection)
- **Log Source:** Windows Security (Event ID 4688: Process Creation)
- **Event Description:** PowerShell execution with `DownloadString` and network connection to the attacker's server

## Detection Logic / Query
I used this Splunk query to detect the activity:This query flags PowerShell processes downloading scripts and connecting to my host.

## Sample Alert Screenshot
<div align="center">
  <img src="fileless_malware_powershell_screenshot.png" alt="Fileless Malware PowerShell Alert" width="600">
</div>

## Logs or Sample Event
From Sysmon (Event ID 1):
From Sysmon (Event ID 3):
## Analyst Notes
- This alert might flag legitimate PowerShell scripts using `DownloadString`. I’d refine it by adding filters for known good IPs or scripts.
- Fileless execution is hard to catch without Sysmon—ensuring proper logging is key.

## Detection Status
Successfully implemented.
